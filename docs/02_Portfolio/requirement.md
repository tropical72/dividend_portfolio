# Requirement: Portfolio (02) & Integration [Deep Dive]

## [REQ-PRT-01] 포트폴리오 설계 및 구성 (Design)
- **[REQ-PRT-01.1] 설계 인터페이스:** 3단 카테고리(Fixed Income, Bond/Cash Buffer, Growth) 섹션 제공.
- **[REQ-PRT-01.2] 항목 관리:** 각 종목의 Ticker, 이름, 비중(Weight, %)을 입력 및 수정 가능. [REQ-04]
- **[REQ-PRT-01.3] 실시간 비중 합산:** 
    - 각 카테고리 내 종목 비중 합계 표시. [REQ-05]
    - 전체 포트폴리오 비중 합계 표시. [REQ-06]
- **[REQ-PRT-01.4] 비중 검증 및 차단:** 
    - 전체 비중 합계가 정확히 100.0%가 아닐 경우 저장 시도 시 **강력 차단**. [REQ-06]
    - 사용자에게 "비중 합계가 100%여야 합니다"라는 경고 메시지와 수정 경로 안내.
- **[REQ-PRT-01.5] 초기화 기능:** '새로만들기' 버튼 제공. 클릭 시 현재 설계 화면의 모든 입력값 초기화. [REQ-09]

## [REQ-PRT-02] Watchlist 유기적 연동 (Integration)
- **[REQ-PRT-02.1] 일괄 이관:** Watchlist에서 복수 종목 선택 시 'Add to Portfolio' 버튼 활성화. 클릭 시 **카테고리 선택 팝업**을 통해 지정된 위치로 종목 일괄 전송. [REQ-01, 03]
- **[REQ-PRT-02.2] 삭제 방지 무결성:** Watchlist에서 종목 삭제 시, 저장된 포트폴리오에 포함된 종목이면 삭제를 차단하고 "사용 중인 종목"임을 알림. [REQ-02]

## [REQ-PRT-03] 통합 시뮬레이션 엔진 (Simulation) [REQ-07, 08]
- **[REQ-PRT-03.1] 통화 이원화 입력:** 총 투자금액을 USD 또는 KRW 구역에 입력 가능.
- **[REQ-PRT-03.2] 실시간 환율 연산:** 한쪽 통화 입력 시 즉시 현재 환율을 적용하여 다른 쪽 통화로 변환 표시 (환율 수치 병기).
- **[REQ-PRT-03.3] 분석 모드 전환:** '과거 이력(TTM)' 또는 '미래 예측(Forward)' 모드 중 선택하여 시뮬레이션 수행.
- **[REQ-PRT-03.4] 분석 결과 보고:** 카테고리별 및 전체에 대해 **연간 배당금, 월간 배당금, 배당률(Yield)**을 표시 (세전 기준).

## [REQ-PRT-04] 영속성 및 데이터 관리 (Storage)
- **[REQ-PRT-04.1] 포트폴리오 저장:** 
    - 현재 구성을 **이름** 및 **계좌 유형**과 함께 저장한다. [REQ-09]
    - **계좌 유형 구분:** 개인계좌(Personal)와 연금계좌(Pension) 중 하나를 선택해야 한다.
    - **이름 필수 입력:** 이름이 비어있을 경우 저장을 차단하고 경고 메시지를 표시한다.
    - **덮어쓰기 로직:** 기존에 저장된 포트폴리오를 편집 중인 경우(ID 존재), 새로운 항목을 생성하지 않고 기존 ID를 유지하며 업데이트한다.
- **[REQ-PRT-04.2] 저장 리스트 관리:** 저장된 포트폴리오의 삭제 및 이름 변경 기능. [REQ-14]
- **[REQ-PRT-04.3] 데이터 로드:** 저장된 포트폴리오를 선택하여 'Portfolio' 설계 탭으로 불러오기. [REQ-13]

## [REQ-PRT-06] 포트폴리오 비교 및 시각화 (Comparison) [REQ-10]
- **[REQ-PRT-06.1] 비교 대시보드:** 저장된 포트폴리오 목록을 나열하여 한눈에 비교.
- **[REQ-PRT-06.2] 아코디언 상세 뷰:** 각 항목 클릭 시 카테고리별 비중, 수익률, 수입(원화 기준)을 펼쳐서 표시. [REQ-11]
- **[REQ-PRT-06.3] 비교 탭 전용 시뮬레이터:** 
    - 상단에 USD/KRW 통합 입력 구역 배치. [REQ-15]
    - 입력 시 리스트 내 모든 포트폴리오의 수치가 입력된 투자금에 맞춰 실시간 갱신.
- **[REQ-PRT-06.4] 월별 수입 그래프:** 
    - 리스트에서 복수(Multiple) 포트폴리오 선택 기능. [REQ-12]
    - 선택된 포트폴리오들의 1월~12월 월별 수입 흐름을 **막대 그래프(Bar Chart)**로 통합 시각화.
